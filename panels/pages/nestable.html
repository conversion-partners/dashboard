<!DOCTYPE html>
<!--[if lt IE 7]>
<html lang="en" class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html lang="en" class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html lang="en" class="lt-ie9"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html lang="en">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, minimum-scale=1">
<title>Nestable</title>
<link rel="stylesheet"
	href="/dashboard/bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet"
	href="/dashboard/bower_components/nestable2/jquery.nestable.css">
<style type="text/css">
.cf:after {
	visibility: hidden;
	display: block;
	font-size: 0;
	content: " ";
	clear: both;
	height: 0;
}

* html .cf {
	zoom: 1;
}

*:first-child+html .cf {
	zoom: 1;
}

html {
	margin: 0;
	padding: 0;
}

body {
	font-size: 100%;
	margin: 0;
	padding: 1.75em;
	font-family: 'Helvetica Neue', Arial, sans-serif;
}

h1 {
	font-size: 1.75em;
	margin: 0 0 0.6em 0;
}

a {
	color: #2996cc;
}

a:hover {
	text-decoration: none;
}

p {
	line-height: 1.5em;
}

.small {
	color: #666;
	font-size: 0.875em;
}

.large {
	font-size: 1.25em;
}

/**
 * Nestable Extras
 */
@media only screen and (min-width: 700px) {
	.dd {
		float: left;
		width: 48%;
	}
	.dd+.dd {
		margin-left: 2%;
	}
}

.dd-hover > .dd-handle {
	background: #f5f5f5 !important;
}

.dd-handle {
	padding-left: 20px;
}
/**
 * Nestable Draggable Handles
 */
.dd-content {
	padding-left: 30px;
}

.dd-item>button {
	left: 30px;
	margin-right: -5px;
}

.dd3-content {
	display: block;
	height: 30px;
	margin: 5px 0;
	margin-left: 15px;
	padding: 5px 10px 5px 40px;
	color: #333;
	text-decoration: none;
	font-weight: bold;
	border: 1px solid #ccc;
	background: #f5f5f5 !important;
	-webkit-border-radius: 3px;
	border-radius: 3px;
	box-sizing: border-box;
	-moz-box-sizing: border-box;
}

.dd3-content:hover {
	color: #2ea8e5;
	background: #fff;
}

.dd-dragel>.dd3-item>.dd3-content {
	margin: 0;
}

.dd3-item>button {
	margin-left: 30px;
}

.dd3-handle {
	position: absolute;
	margin: 0;
	left: 0;
	top: 0;
	cursor: pointer;
	width: 30px;
	text-indent: 100%;
	white-space: nowrap;
	overflow: hidden;
	border: 1px solid #aaa;
	background: #ddd;
	background: -webkit-linear-gradient(top, #ddd 0%, #bbb 100%);
	background: -moz-linear-gradient(top, #ddd 0%, #bbb 100%);
	background: linear-gradient(top, #ddd 0%, #bbb 100%);
	border-top-right-radius: 0;
	border-bottom-right-radius: 0;
}

.dd3-handle:before {
	content: 'â‰¡';
	display: block;
	position: absolute;
	left: 0;
	top: 3px;
	width: 100%;
	text-align: center;
	text-indent: 0;
	color: #fff;
	font-size: 20px;
	font-weight: normal;
}

.dd3-handle:hover {
	background: #ddd;
}

/** table example **/

/** content **/
#content {
	width: calc(100% - 450px);
	margin-left: 300px;
	position: relative;
}

#nestable {
	margin-right: 50px;
	width: 500px;
}

#menuitemcontent {
	background-color: #fff;
	position: absolute;
	width: calc(100% - 700px);
	min-height: 500px;
	left: 550px;
	top: -15px;
}
</style>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="/dashboard/bower_components/nestable2/jquery.nestable.js"></script>
<script
	src="/dashboard/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script
	src="/dashboard/bower_components/json-editor/dist/jsoneditor.min.js"></script>
</head>
<body>



	<div id="content" class="cf nestable-lists">

		<div class="dd" id="nestable"></div>

		<div id="menuitemcontent">

			<div id='editor_holder'></div>
			<button id='submit'>Submit (console.log)</button>

		</div>


	</div>


	<script>
	
	Core9 = {};
	Core9.editor = {};
	
	
	var activateEditor = function(page){
	try {
		Core9.editor.destroy();
	} catch (e) {
		// TODO: handle exception
	}

		
		
   	Core9.editor = new JSONEditor(document.getElementById('editor_holder'),{
	    	disable_edit_json : true,
	    	disable_collapse : true,
	    	disable_properties : true,
	    	format : 'grid',
	    	theme: 'bootstrap3',
	        schema: {
	          type: "object",
	          title: page,
	          properties: {
	            make: {
	              type: "string",
	              enum: [
	                "Toyota",
	                "BMW",
	                "Honda",
	                "Ford",
	                "Chevy",
	                "VW"
	              ]
	            },
	            model: {
	              type: "string"
	            },
	            year: {
	              type: "integer",
	              enum: [
	                1995,1996,1997,1998,1999,
	                2000,2001,2002,2003,2004,
	                2005,2006,2007,2008,2009,
	                2010,2011,2012,2013,2014
	              ],
	              default: 2008
	            }
	          }
	        }
	      });
	      
	      // Hook up the submit button to log to the console
	      document.getElementById('submit').addEventListener('click',function() {
	        // Get the value from the editor
	        console.log(editor.getValue());
	      });
	
	}
	

    $(document).ready(function() {
    	
    	


        var json = [
                    {
                        "id": 1,
                        "content": "First item",
                        "classes": ["dd-nochildren"]
                    },
                    {
                        "id": 2,
                        "content": "Second item",
                        "children": [
                            {
                                "id": 3,
                                "content": "Item 3"
                            },
                            {
                                "id": 4,
                                "content": "Item 4"
                            },
                            {
                                "id": 5,
                                "content": "Item 5",
                                "value": "Item 5 value",
                                "foo": "Bar",
                                "children": [
                                    {
                                        "id": 6,
                                        "content": "Item 6"
                                    },
                                    {
                                        "id": 7,
                                        "content": "Item 7"
                                    },
                                    {
                                        "id": 8,
                                        "content": "Item 8"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": 9,
                        "content": "Item 9"
                    },
                    {
                        "id": 10,
                        "content": "Item 10",
                        "children": [
                            {
                                "id": 11,
                                "content": "Item 11",
                                "children": [
                                    {
                                        "id": 12,
                                        "content": "Item 12"
                                    }
                                ]
                            }
                        ]
                    }
                ];
        
        var updateOutput = function(){
        	//console.log('update menu');
        	var content = $('#nestable').nestable('serialize');
			console.log(content);
			console.log(JSON.stringify(content));
			

			
        }

        $('#nestable').nestable({
            group: 1,
            maxDepth:40,
            json: json,
            contentCallback: function(item) {
                var content = item.content || '' ? item.content : item.id;
                content += '<div class="dd-handle dd3-handle">Drag</div>';

                return content;
            },
            callback: function(l,e){
                //console.log(l);
                var page = $(e[0]).find('.dd-content')[0].childNodes[0].textContent;
                
                activateEditor(page);
                
            }
        }).on('change', updateOutput);
    	
        

        
    });
</script>
</body>
</html>
